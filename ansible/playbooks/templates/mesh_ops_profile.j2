# Mesh-Ops User Profile - {{ ansible_hostname }}
# Generated by Ansible on {{ ansible_date_time.iso8601 }}

# User identification
export USER="mesh-ops"
export MESH_USER="mesh-ops"
export MESH_NODE_TYPE="{{ mesh_node_type | default('standard') }}"
export MESH_NODE_NAME="{{ ansible_hostname }}"

# Path configuration
export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/.bun/bin:$PATH"
export PATH="$HOME/go/bin:$PATH"
export PATH="$HOME/Scripts:$PATH"

# Development environment
export EDITOR="${EDITOR:-vim}"
export VISUAL="${VISUAL:-vim}"
export PAGER="${PAGER:-less}"

# XDG Base Directory Specification
export XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"
export XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"
export XDG_STATE_HOME="${XDG_STATE_HOME:-$HOME/.local/state}"
export XDG_CACHE_HOME="${XDG_CACHE_HOME:-$HOME/.cache}"
export XDG_RUNTIME_DIR="${XDG_RUNTIME_DIR:-/run/user/{{ mesh_uid }}}"

# Tool-specific configuration
export UV_CACHE_DIR="$XDG_CACHE_HOME/uv"
export BUN_INSTALL="$HOME/.bun"
export MISE_DATA_DIR="$XDG_DATA_HOME/mise"
export CARGO_HOME="${CARGO_HOME:-$HOME/.cargo}"
export RUSTUP_HOME="${RUSTUP_HOME:-$HOME/.rustup}"
export GOPATH="${GOPATH:-$HOME/go}"

# Mesh network configuration
export TAILSCALE_SOCKET="${TAILSCALE_SOCKET:-/var/run/tailscale/tailscaled.sock}"
{% if mesh_node_type == 'wsl' %}
# WSL2-specific configuration
export WSL_ENV=true
export TAILSCALE_SOCKET="$HOME/.tailscale/tailscaled.sock"
{% endif %}

# History configuration
export HISTSIZE=10000
export HISTFILESIZE=20000
export HISTCONTROL=ignoreboth:erasedups
export HISTTIMEFORMAT="%F %T "

# Less configuration
export LESS="-R -F -X"
export LESSHISTFILE="$XDG_STATE_HOME/lesshst"

# Source additional configurations
if [ -d "$HOME/.profile.d" ]; then
    for f in "$HOME/.profile.d"/*.sh; do
        [ -r "$f" ] && . "$f"
    done
fi

# Set default working directory
if [ -d "$HOME/Projects" ]; then
    cd "$HOME/Projects" 2>/dev/null || true
fi

# Display welcome message
if [ -n "$PS1" ]; then
    echo "Mesh-Ops Environment - Node: {{ ansible_hostname }}"
    echo "Type: {{ mesh_node_type | default('standard') }}"
fi